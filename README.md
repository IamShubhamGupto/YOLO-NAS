# YOLO-NAS
Train and Inference your custom YOLO-NAS model by single Command Line

# About YOLO-NAS
**A Next-Generation, Object Detection Foundational Model generated by Deciâ€™s Neural Architecture Search Technology**<br>
Deci is thrilled to announce the release of a new object detection model, YOLO-NAS - a game-changer in the world of object detection, providing superior real-time object detection capabilities and production-ready performance. Deci's mission is to provide AI teams with tools to remove development barriers and attain efficient inference performance more quickly.

## Build your first custom YOLO-NAS model
- Clone the Repository
- Install dependencies
- Prepare dataset
- Train your custom YOLO-NAS model
- Inference your custom YOLO-NAS model on Camera/Video/RTSP

# ðŸ˜Ž Custom YOLO-NAS Model
### Clone this Repository
```
git clone https://github.com/naseemap47/YOLO-NAS.git
cd YOLO-NAS
```
### Install dependencies
```
pip3 install -r requirement.txt
```
### ðŸŽ’ Prepare Dataset
Your custom dataset should be in COCO data format.<br>
**COCO Data Format**:
```
â”œâ”€â”€ Dataset
â”‚   â”œâ”€â”€ train
â”‚   â”‚   â”œâ”€â”€ images
â”‚   â”‚   â”‚   â”œâ”€â”€ 1.jpg
â”‚   â”‚   â”‚   â”œâ”€â”€ abc.png
|   |   |   â”œâ”€â”€ ....
â”‚   â”‚   â”œâ”€â”€ labels
â”‚   â”‚   â”‚   â”œâ”€â”€ 1.txt
â”‚   â”‚   â”‚   â”œâ”€â”€ abc.txt
|   |   |   â”œâ”€â”€ ....
â”‚   â”œâ”€â”€ val
â”‚   â”‚   â”œâ”€â”€ images
â”‚   â”‚   â”‚   â”œâ”€â”€ 2.jpg
â”‚   â”‚   â”‚   â”œâ”€â”€ fram.png
|   |   |   â”œâ”€â”€ ....
â”‚   â”‚   â”œâ”€â”€ labels
â”‚   â”‚   â”‚   â”œâ”€â”€ 2.txt
â”‚   â”‚   â”‚   â”œâ”€â”€ fram.txt
|   |   |   â”œâ”€â”€ ....
â”‚   â”œâ”€â”€ test
â”‚   â”‚   â”œâ”€â”€ images
â”‚   â”‚   â”‚   â”œâ”€â”€ img23.jpeg
â”‚   â”‚   â”‚   â”œâ”€â”€ 50.jpg
|   |   |   â”œâ”€â”€ ....
â”‚   â”‚   â”œâ”€â”€ labels
â”‚   â”‚   â”‚   â”œâ”€â”€ img23.txt
â”‚   â”‚   â”‚   â”œâ”€â”€ 50.txt
|   |   |   â”œâ”€â”€ ....
```

To training custom model using your custom data.
You need to create [data.yaml](https://github.com/naseemap47/YOLO-NAS/blob/master/data.yaml)
Example:
```
names:
- class1
- class2
- class3
Dir: '/home/user/my_data'  # path to your custom data
images:
  test: test/images
  train: train/images
  val: valid/images
labels:
  test: test/labels
  train: train/labels
  val: valid/labels
```

## ðŸ¤– Train
You can train your YOLO-NAS model with single Command Line

<details>
  <summary>Args</summary>
  
  `-i`, `--data`: path to data.yaml <br>
  `-n`, `--name`: Checkpoint dir name <br>
  `-b`, `--batch`: Training batch size <br>
  `-e`, `--epoch`: number of training epochs.<br>
  `-j`, `--worker`: Training number of workers <br>
  `-m`, `--model`: Model type (eg: `yolo_nas_s`, `yolo_nas_m`, `yolo_nas_l`) <br>
  `-w`, `--weight`: path to pre-trained model weight (default: `coco` weight)
  
</details>

**Example:**
```
python3 train.py --data /dir/dataset/data.yaml --batch 6 --epoch 100 --model yolo_nas_m
```

## ðŸ“º Inference
You can Inference your YOLO-NAS model with single Command Line
#### Support
- Video
- Camera
- RTSP

<details>
  <summary>Args</summary>
  
  `-i`, `--data`: path to data.yaml <br>
  `-m`, `--model`: Model type (eg: `yolo_nas_s`, `yolo_nas_m`, `yolo_nas_l`) <br>
  `-w`, `--weight`: path to trained model weight <br>
  `-s`, `--source`: video path/cam-id/RTSP <br>
  `-c`, `--conf`: model prediction confidence (0<conf<1) <br>
  `--save`: to save video

</details>

**Example:**
```
python3 inference.py --data /dir/dataset/data.yaml --model yolo_nas_m --weight /runs/train4/ckpt_best.pth --source /test/video.mp4 --conf 0.66           # video
                                                                                                          --source /test/video.mp4 --conf 0.75 --save    # to save
                                                                                                          --source 0 --conf 0.45                         # Camera
                                                                                                          --source 'rtsp://link' --conf 0.25             # RTSP

```